<?xml version="1.0" encoding="UTF-8"?>
<html
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:chiba="http://chiba.sourceforge.net/xforms"
    xmlns:xforms="http://www.w3.org/2002/xforms"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <head>
        <title>Actions</title>
        <!-- nonsense example as syntax showcase for 'conditional user-agent stylesheet switching'
        (these are the default stylesheets anyway if nothing is put here)-->
        <style type="text/css">
            .buttons{background:silver;}
            #switchmsg{font-size:14pt;padding:10px;background:#A42322;color:white;text-align:center;}
        </style>

        <xforms:model id="C-1">
            <xforms:submission id="save" action="../jsp/debug-instance.jsp" method="post"
                replace="all"/>
            <xforms:submission id="save1" action="../jsp/debug-instance.jsp" method="post"
                replace="all" ref="instance('default')/repeatdata"/>
            <xforms:submission id="debug" action="../jsp/generate-instance.jsp" method="post"
                replace="instance"/>
            <xforms:submission id="exit" action="../jsp/return-instance.jsp" method="post"
                replace="none"/>

            <xforms:instance xmlns="" id="default">
                <data>
                    <helloworld hw="4711">Hello World</helloworld>
                    <repeatdata>
                        <input>aaa</input>
                        <input>bbb</input>
                        <input>ccc</input>
                    </repeatdata>
                    <extra>Got it!</extra>
                    <message>Hello !</message>
                    <titletext>These are examples of XForms Action usage.</titletext>
                </data>
            </xforms:instance>

            <xforms:bind id="repeat1" nodeset="repeatdata/input[position() != last()]" constraint="count(../*) &gt; 3">
                <xforms:bind id="entry" nodeset="." />
            </xforms:bind>
            <xforms:bind id="helloworld" nodeset="helloworld" constraint="string-length(.) &gt; 5" required="true()" type="string"/>
            <xforms:bind id="hw" nodeset="helloworld/@hw" required="true()" type="integer"/>
            <xforms:bind id="extra" nodeset="extra" relevant="count(../repeatdata/input) &gt; 3"/>
            <xforms:bind id="message-action" nodeset="message"/>
            <xforms:bind id="insert-btn" nodeset="repeatdata" readonly="count(*) = 1" />
        </xforms:model>
    </head>
    <body>
        <xforms:group appearance="full">
            <xforms:label>
                <b>XForms Actions</b> -
                <xforms:output ref="titletext"/>
            </xforms:label>
            <xforms:group class="buttons" appearance="minimal">
                <!--<xforms:label>rebuild, recalculate, revalidate, refresh</xforms:label>-->
                <xforms:trigger>
                    <xforms:label>rebuild</xforms:label>
                    <xforms:action>
                        <xforms:rebuild/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger>
                    <xforms:label>recalculate</xforms:label>
                    <xforms:action>
                        <xforms:recalculate/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger>
                    <xforms:label>revalidate</xforms:label>
                    <xforms:action>
                        <xforms:revalidate/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger>
                    <xforms:label>refresh</xforms:label>
                    <xforms:action>
                        <xforms:refresh/>
                    </xforms:action>
                </xforms:trigger>
            </xforms:group>
            <xforms:group appearance="minimal">
                <xforms:label>setValue</xforms:label>
                <xforms:trigger>
                    <xforms:label>setvalue 'Hello'</xforms:label>
                    <xforms:hint appearance="chiba:bubble">use setvalue to explicitly set specific values to nodes in the instance.</xforms:hint>
                    <xforms:setvalue bind="helloworld" value="'Hello'"/>
                </xforms:trigger>
                <xforms:trigger>
                    <xforms:label>setvalue 'Hello World'</xforms:label>
                    <xforms:hint>
						use setvalue to explicitly set specific values to nodes in the instance.
                    </xforms:hint>
                    <xforms:action>
                        <xforms:setvalue bind="helloworld" value="'Hello World'"/>
                    </xforms:action>
                </xforms:trigger>
                <br/>
                <xforms:input bind="helloworld" incremental="true">
                    <xforms:label>input 1</xforms:label>
                    <xforms:help>
                        In <b>scripted mode</b> you can check out the <b>incremental</b> feature here. You will see your input
                        will be validated as you type. As soon as you have input 5 characters the red background
                        will disappear and the control will become valid.
                    </xforms:help>
                    <xforms:hint>you <b>have</b> to provide a "text" with more than 5 characters</xforms:hint>
                    <xforms:alert>please specify a text longer than 5 characters</xforms:alert>
                </xforms:input>
            </xforms:group>
            <xforms:group appearance="minimal">
                <xforms:label>setValue2</xforms:label>
                <xforms:trigger>
                    <xforms:label>setvalue 'text'</xforms:label>
                    <xforms:hint>
						use setvalue to explicitly set specific values to nodes in the instance.
                    </xforms:hint>
                    <xforms:action>
                        <xforms:setvalue bind="hw" value="'text'"/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger>
                    <xforms:label>setvalue '4711'</xforms:label>
                    <xforms:hint>
						use setvalue to explicitly set specific values to nodes in the instance.
                    </xforms:hint>
                    <xforms:action>
                        <xforms:setvalue bind="hw" value="'4711'"/>
                    </xforms:action>
                </xforms:trigger>
                <br/>
                <xforms:input bind="hw">
                    <xforms:label>input 2</xforms:label>
                    <xforms:hint>this field only accepts numbers</xforms:hint>
                    <xforms:alert>please specify a number</xforms:alert>
                    <xforms:help>Another help text just to show it's working. Only one of them can be visible
                    at a time but for most cases this should be sufficient. If you need a global help file you can
                    use a load/@show="new" to open up a new window with a complete textfile.</xforms:help>
                </xforms:input>
            </xforms:group>
            <xforms:group appearance="minimal">
                <xforms:label>Repeat - insert, delete, move top, move bottom</xforms:label>
                <xforms:trigger>
                    <xforms:label>Append</xforms:label>
                    <xforms:hint>appends a new entry at the end of this collection</xforms:hint>
                    <xforms:action>
                        <xforms:insert nodeset="repeatdata/input"
                            xforms:at="last()=1" position="after"/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger bind="insert-btn">
                    <xforms:label>Insert after selected</xforms:label>
                    <xforms:hint>appends a new entry at the end of this collection</xforms:hint>
                    <xforms:action>
                        <xforms:insert bind="repeat1"
                            xforms:at="xforms:index('repeatid')" position="after"/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger>
                    <xforms:label>Delete selected</xforms:label>
                    <xforms:hint>deletes selected entry from this collection</xforms:hint>
                    <xforms:action>
                        <xforms:delete bind="repeat1" at="xforms:index('repeatid')"/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger>
                    <xforms:label>Delete last entry</xforms:label>
                    <xforms:hint>deletes last entry from this collection</xforms:hint>
                    <xforms:action>
                        <xforms:delete bind="repeat1" at="last()"/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger>
                    <xforms:label>Top of List</xforms:label>
                    <xforms:hint>move cursor to top of list</xforms:hint>
                    <xforms:action>
                        <xforms:setindex index="1" repeat="repeatid"/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger>
                    <xforms:label>Bottom of list</xforms:label>
                    <xforms:hint>move cursor to bottom of list</xforms:hint>
                    <xforms:action>
                        <xforms:setindex index="count(../input)-1" repeat="repeatid"/>
                    </xforms:action>
                </xforms:trigger>
                <div style="float:left;font-weight:bold;width:100px;margin:10px;">There must be at least 3 entries in this repeat to be valid</div>
                <xforms:repeat id="repeatid" bind="repeat1" appearance="full">
                    <xforms:input bind="entry">
                        <xforms:label>repeated input:</xforms:label>
                        <xforms:hint>repeated enty</xforms:hint>
                    </xforms:input>
                </xforms:repeat>
                <xforms:output bind="extra"/>
            </xforms:group>
            <xforms:group appearance="minimal">
                <xforms:label>switch / toggle</xforms:label>
                <xforms:trigger id="on-button">
                    <xforms:label>ON</xforms:label>
                    <xforms:hint>toggles switch to on</xforms:hint>
                    <xforms:action>
                        <xforms:toggle case="case1"/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger id="off-button">
                    <xforms:label>OFF</xforms:label>
                    <xforms:hint>toggles switch to off</xforms:hint>
                    <xforms:action>
                        <xforms:toggle case="case2"/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:switch id="switch">
                    <xforms:case id="case1" selected="false">
                        <div id="switchmsg">
                            Switch is turned on!
                        </div>
                    </xforms:case>
                    <xforms:case id="case2" selected="true">
                        <h1>Switch is turned off!</h1>
                    </xforms:case>
                </xforms:switch>
            </xforms:group>
            <xforms:group class="buttons" appearance="minimal">
                <xforms:label>Misc</xforms:label>
                <xforms:trigger>
                    <xforms:label>Dispatch (toggle ON)</xforms:label>
                    <xforms:hint>dispatches DOMActivate to the 'ON' button</xforms:hint>
                    <xforms:action>
                        <xforms:dispatch name="DOMActivate" target="on-button"/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger bind="message-action">
                    <xforms:label>Load (new)</xforms:label>
                    <xforms:action>
                        <xforms:load resource="images/chiba50t.gif" show="new"/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger>
                    <xforms:label>Load (replace)</xforms:label>
                    <xforms:action>
                        <xforms:load resource="../XFormsServlet?form=/forms/address.xhtml&amp;JavaScript=enabled'" show="replace"/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger>
                    <xforms:label>Message</xforms:label>
                    <xforms:action>
                        <xforms:message level="modal" bind="message-action"/>
                    </xforms:action>
                </xforms:trigger>
            </xforms:group>
            <xforms:group class="buttons" appearance="minimal">
                <!--				<xforms:label>Send, Reset</xforms:label>-->
                <xforms:trigger>
                    <xforms:label>Show new document (replace=all)</xforms:label>
                    <xforms:hint>shows submitted instance data in a separate JSP page</xforms:hint>
                    <xforms:action>
                        <xforms:send submission="save"/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger>
                    <xforms:label>Select partial document (replace=all)</xforms:label>
                    <xforms:hint>shows partial instance data in a separate JSP page</xforms:hint>
                    <xforms:action>
                        <xforms:send submission="save1"/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger>
                    <xforms:label>Show returned instance (replace=instance)</xforms:label>
                    <xforms:hint>imports generated instance data into the current form</xforms:hint>
                    <xforms:action>
                        <xforms:send submission="debug"/>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger>
                    <xforms:label>Just send (replace=none)</xforms:label>
                    <xforms:hint>submits instance data and ignores any response</xforms:hint>
                    <xforms:action>
                        <xforms:send submission="exit"/>
                        <xforms:message level="ephemeral">Your data have been send.</xforms:message>
                    </xforms:action>
                </xforms:trigger>
                <xforms:trigger>
                    <xforms:label>Reset</xforms:label>
                    <xforms:hint>reset instance data to original values</xforms:hint>
                    <xforms:action>
                        <xforms:reset/>
                        <xforms:toggle case="case2"/>
                    </xforms:action>
                </xforms:trigger>
            </xforms:group>
        </xforms:group>
    </body>
</html>